# Projet

from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time
import os  # permet d'aller écrire dans les répertoires
from openpyxl import Workbook


option = webdriver.ChromeOptions()
option.add_argument("--incognito")  # Navigation privée
# option.add_argument("kiosk")  # grand ecran sur mac
#prefs={"profile.managed_default_content_settings.images": 2, 'disk-cache-size': 4096 }
#option.add_experimental_option('prefs', prefs)

browser = webdriver.Chrome(
    executable_path="/Users/thomasbouiniere/Desktop/Scrapping/chromedriver", options=option)

browser.get('https://www.betclic.fr')

time.sleep(2)

button = browser.find_element_by_xpath('//*[@id="popin_tc_privacy_button_2"]')
button.click()

cote1 = browser.find_element_by_xpath(
    '/html/body/app-desktop/div[1]/div/bcdk-content-scroller/div/sports-home-page/sports-carousel/div/div/ul/div[2]/sports-events-event/a/sports-events-event-markets/sports-markets-default/div/sports-selections-selection[1]/div[1]/span[2]')
cote2 = browser.find_element_by_xpath(
    '/html/body/app-desktop/div[1]/div/bcdk-content-scroller/div/sports-home-page/sports-carousel/div/div/ul/div[2]/sports-events-event/a/sports-events-event-markets/sports-markets-default/div/sports-selections-selection[3]/div[1]/span[2]')
cotes = browser.find_elements_by_xpath(
    '/html/body/app-desktop/div[1]/div/bcdk-content-scroller/div/sports-home-page/sports-carousel/div/div/ul/div[2]/sports-events-event/a/sports-events-event-markets/sports-markets-default/div/sports-selections-selection/div[1]/span[2]')


try:
    exp = browser.find_elements_by_xpath(
        '/html/body/app-desktop/div[1]/div/bcdk-content-scroller/div/sports-home-page/sports-carousel/div/div/ul/div/sports-events-event/a/sports-events-event-markets/sports-markets-default/div/sports-selections-selection/div[1]/span[2]')
except:
    print(None)

for x in exp:
    print(x.text)
